<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>REEL-4 Receptive and Expressive</title>
    <style>
        body {
            background-color: linen;
        }

        #inputAreaLeft {
            margin: 0 0 15px 0;
        }

        .container {
            margin: 5px 0;
            line-height: 25px;
        }

        h2 {
            margin: 8px 0 0 0;
        }

        .h2_receptive {
            color: black;
        }

        .h2_expressive {
            color: blue;
        }

        .rb-title {
            font-family: monospace;
            font-size: 14px;
            padding: 0 0px 0 7px;
        }

        .rb-label {
            padding: 0 0 0 10px;
        }

        .createReportButton {
            font-family: sans-serif;
            font-size: 14px;
            color: white;
            padding: 6px;
            border: 0px solid blue;
            border-radius: 5px;
            background-color: #875f9a;
            outline: none;
        }

        #leftColumn {
            float: left;
            width: 550px;
        }

        #rightColumn {
            float: left;
            width: 550px;
        }

        .bulletPointOutput {
            font-size: 10pt;
            font-family: "Calibri", serif;
            border: 5px solid #ccc;
            border-radius: 5px;
            outline: none;
            margin-top: 5px;
            background-color: #debaba;
            width: 90%;
        }

        #displayArea {
            margin-left: 400px;
        }

        input[type='radio'] {
            transform: scale(1.5);
        }
    </style>
</head>
<body>
    <div id="displayArea">
    <div id="leftColumn">
        <div id="inputAreaLeft"></div>

        <div class="container">
            <button class="createReportButton" id="createReport-left">Create language RECEPTIVE bullet points from current selection</button><br>
            <div class="bulletPointOutput" id="bulletPointOutput-receptive"></div>
        </div>
    </div>

    <div id="rightColumn">
        <div id="inputAreaRight"></div>

        <div class="container">
            <button class="createReportButton" id="createReport-right">Create language EXPRESSIVE bullet points from current selection</button><br>
            <div class="bulletPointOutput" id="bulletPointOutput-expressive"></div>
        </div>
    </div>
    </div><!--id=displayArea-->

    <script>
    var ageGroupLabels = [
        "0-6 Months",
        "7-12 Months",
        "13-22 Months",
        "23-27 Months",
        "28-36 Months"
    ];

    var textItems = {
        receptive: [
            { group: 0, index: 1,  itemText: "Briefly responds to a loud noise by blinking eyes or jerking whole body, and returns to normal appearance" },
            { group: 0, index: 2,  itemText: "Is quieted by a familiar voice when fussy" },
            { group: 0, index: 3,  itemText: "Stops moving when hearing unusual sounds" },
            { group: 0, index: 4,  itemText: "Looks toward the speaker" },
            { group: 0, index: 5,  itemText: "Looks toward new sounds or voices" },
            { group: 0, index: 6,  itemText: "Looks directly at speaker's face" },
            { group: 0, index: 7,  itemText: "Turns head and eyes toward a speaker" },
            { group: 0, index: 8,  itemText: "Looks at a nearby speaker when not directly spoken to" },
            { group: 0, index: 9,  itemText: "Stops crying when hearing a comforting voice" },
            { group: 0, index: 10, itemText: "Looks towards a speaker and smiles" },
            { group: 0, index: 11, itemText: "Becomes disturbed when hearing an angry voice" },
            { group: 0, index: 12, itemText: "Looks specifically at the speaker's mouth and lips" },
            { group: 0, index: 13, itemText: "Looks around and tries to find the person who is speaking" },
            { group: 0, index: 14, itemText: "Locates where a voice is coming from" },

            { group: 1, index: 15, itemText: "Responds to own name" },
            { group: 1, index: 16, itemText: "Exhibits different responses to different tones of voice" },
            { group: 1, index: 17, itemText: "Listens with interest when hearing music" },
            { group: 1, index: 18, itemText: "Stops regularly when hearing own name during play" },
            { group: 1, index: 19, itemText: "Understand meaning of \"daddy,\" \"mama,\" or \"bye-bye\"" },
            { group: 1, index: 20, itemText: "Responds to \"no\" or \"stop that\" half of the time" },
            { group: 1, index: 21, itemText: "Stops own action and listens to conversations between people" },
            { group: 1, index: 22, itemText: "Understands \"up\" or \"bye\" and gesture in answer" },
            { group: 1, index: 23, itemText: "Responds to \"no\" or \"stop that\" almost every time" },
            { group: 1, index: 24, itemText: "Listens when someone is talking without being distracted" },
            { group: 1, index: 25, itemText: "Reacts to the name of a family member who is not present" },
            { group: 1, index: 26, itemText: "Enjoys hearing names of familiar objects" },
            { group: 1, index: 27, itemText: "Moves to music's beat" },
            { group: 1, index: 28, itemText: "Looks at familiar objects when mentioned" },

            { group: 2, index: 29, itemText: "Responds to commands such as \"let's go\" or \"come here\"" },
            { group: 2, index: 30, itemText: "Sits still and listens for a full minute to a person naming familiar objects" },
            { group: 2, index: 31, itemText: "Understands simple \"where\" questions" },
            { group: 2, index: 32, itemText: "Listens for a long time when some talks" },
            { group: 2, index: 33, itemText: "Follows simple directions such as \"Give me five\" or \"Show me your nose\"" },
            { group: 2, index: 34, itemText: "Complies when asked to bring/find objects" },
            { group: 2, index: 35, itemText: "Understands new words each week" },
            { group: 2, index: 36, itemText: "Understands familiar routines" },
            { group: 2, index: 37, itemText: "Complies when asked to say social routine words" },

            { group: 3, index: 38, itemText: "Enjoys listening to nursery rhymes, finger plays, or songs" },
            { group: 3, index: 39, itemText: "Recognizes a toy not in sight when mentioned" },
            { group: 3, index: 40, itemText: "Points to objects and pictures upon verbal request" },
            { group: 3, index: 41, itemText: "Points to major body parts" },
            { group: 3, index: 42, itemText: "Understands \"because\" answer to a \"why\" question" },

            { group: 4, index: 43, itemText: "Follows two-step commands" },
            { group: 4, index: 44, itemText: "Understands adult language" },
            { group: 4, index: 45, itemText: "Recognizes the meanings of new words each day" },
            { group: 4, index: 46, itemText: "Complies when asked to perform basic actions without cues" },
            { group: 4, index: 47, itemText: "Understands commands with third person pronouns" },
            { group: 4, index: 48, itemText: "Pauses during conversation and waits for the partner to comment" },
            { group: 4, index: 49, itemText: "Understands category concepts" },
            { group: 4, index: 50, itemText: "Understands the meaning of most of the objects and actions in conversation or in pictures" },
            { group: 4, index: 51, itemText: "Identifies objects out of multiple choices" },
            { group: 4, index: 52, itemText: "Understands and follows conversations between characters on children's programs" },
            { group: 4, index: 53, itemText: "Points to smaller body parts" },
            { group: 4, index: 54, itemText: "Follows three-step commands" },
            { group: 4, index: 55, itemText: "Points to pictures involving actions when asked wh-questions" },
            { group: 4, index: 56, itemText: "Has a sense of humor" },
            { group: 4, index: 57, itemText: "Understands the meaning of longer spoken sentences" },
            { group: 4, index: 58, itemText: "Understands location phrases" },
            { group: 4, index: 59, itemText: "Understands complex sentences" },
            { group: 4, index: 60, itemText: "Remembers familiar events and sequences of favorite stories" },
            { group: 4, index: 61, itemText: "Understands indirect requests" },
            { group: 4, index: 62, itemText: "Follows directions involving objects that are not visible" },
            { group: 4, index: 63, itemText: "Understands size or color concepts" },
            { group: 4, index: 64, itemText: "Answers yes/no questions about playmates or family members when referred by family relationships" },
            { group: 4, index: 65, itemText: "Listens to explanations of how things work" },
            { group: 4, index: 66, itemText: "Understands the emotions behind what is said to him/her" },
            { group: 4, index: 67, itemText: "Understands about past or future events" },
            { group: 4, index: 68, itemText: "Identifies simple shapes" },
            { group: 4, index: 69, itemText: "Understands describing words" },
            { group: 4, index: 70, itemText: "Attends to a short story and answers questions about it" },
            { group: 4, index: 71, itemText: "Indicates he/she does not understand what is said" },
            { group: 4, index: 72, itemText: "Understands number words" },
            { group: 4, index: 73, itemText: "Understands idioms" },
            { group: 4, index: 74, itemText: "Identifies left and right" },
        ],

        expressive: [
            { group: 0, index: 1,  itemText: "Makes sounds other than crying" },
            { group: 0, index: 2,  itemText: "Cries in a loud, clear voice" },
            { group: 0, index: 3,  itemText: "Makes sounds in contentment during or after feeding" },
            { group: 0, index: 4,  itemText: "Produces vowel-like sounds" },
            { group: 0, index: 5,  itemText: "Produces different crying sounds when hungry" },
            { group: 0, index: 6,  itemText: "Makes happy sounds" },
            { group: 0, index: 7,  itemText: "Laughs and makes other happy sounds" },
            { group: 0, index: 8,  itemText: "Vocalizes back to a voice" },
            { group: 0, index: 9,  itemText: "Makes more sounds when caregiver is present" },
            { group: 0, index: 10, itemText: "Produces new sounds" },
            { group: 0, index: 11, itemText: "Vocalizes to express displeasure" },
            { group: 0, index: 12, itemText: "Starts babbling when seeing another person" },
            { group: 0, index: 13, itemText: "Laughs or chatters when playing with toys" },
            { group: 0, index: 14, itemText: "Repeats same sounds or syllables" },

            { group: 1, index: 15, itemText: "Babbles or chatters playfully" },
            { group: 1, index: 16, itemText: "Produces bilabial consonant-vowel combinations" },
            { group: 1, index: 17, itemText: "Produces 2-syllable combinations" },
            { group: 1, index: 18, itemText: "Shouts to get attention" },
            { group: 1, index: 19, itemText: "Keeps one's body quiet while making sounds" },
            { group: 1, index: 20, itemText: "Talks mostly with contented voice" },
            { group: 1, index: 21, itemText: "Vocalizes to keep caregiver's attention" },
            { group: 1, index: 22, itemText: "Plays games such as pat-a-cake or peek-a-boo" },
            { group: 1, index: 23, itemText: "Vocalizes when heard own name" },
            { group: 1, index: 24, itemText: "Produces consonant-vowel combinations" },
            { group: 1, index: 25, itemText: "Produces made-up words to name objects" },
            { group: 1, index: 26, itemText: "Imitates speech produced by other people" },
            { group: 1, index: 27, itemText: "Jabbers when talking to toys" },
            { group: 1, index: 28, itemText: "Uses firm voice and/or gestures when requesting items" },

            { group: 2, index: 29, itemText: "Reacts to songs by trying to sing along" },
            { group: 2, index: 30, itemText: "Uses exclamatory expressions" },
            { group: 2, index: 31, itemText: "Produces words that are intelligible to familiar listeners" },
            { group: 2, index: 32, itemText: "Produces words to get needs met" },
            { group: 2, index: 33, itemText: "Produces sentences or phrases using word approximations" },
            { group: 2, index: 34, itemText: "Produces question-like intonational pattern" },
            { group: 2, index: 35, itemText: "Greets people with words such as \"hi\" or \"bye-bye\"" },
            { group: 2, index: 36, itemText: "Produces real words that are intelligible to unfamiliar listeners" },
            { group: 2, index: 37, itemText: "Comments to get caregiver to pay attention to objects/people" },

            { group: 3, index: 38, itemText: "Imitates environmental noises or animal sounds" },
            { group: 3, index: 39, itemText: "Produces real words and gestures when talking to someone" },
            { group: 3, index: 40, itemText: "Repeats or imitates words heard in conversations" },
            { group: 3, index: 41, itemText: "Repeats or practices preferred words" },
            { group: 3, index: 42, itemText: "Labels favorite toys, foods, pets, or other objects" },

            { group: 4, index: 43, itemText: "Repeats some of the words from sentences" },
            { group: 4, index: 44, itemText: "Produces two-word phrases" },
            { group: 4, index: 45, itemText: "Produces initial and final sounds of the word" },
            { group: 4, index: 46, itemText: "Produces 50 words" },
            { group: 4, index: 47, itemText: "Produces \"I wanna\" or \"I don’t wanna\"" },
            { group: 4, index: 48, itemText: "Produces past tense -ed" },
            { group: 4, index: 49, itemText: "Verbalizes personal needs" },
            { group: 4, index: 50, itemText: "Produces prepositions" },
            { group: 4, index: 51, itemText: "Produces pronouns" },
            { group: 4, index: 52, itemText: "Refers to friends by name" },
            { group: 4, index: 53, itemText: "Shows signs of frustration when not understood" },
            { group: 4, index: 54, itemText: "Produces size and color words" },
            { group: 4, index: 55, itemText: "Produces intelligible speech most of the time" },
            { group: 4, index: 56, itemText: "Rephrases when not understood" },
            { group: 4, index: 57, itemText: "Produces plural -s" },
            { group: 4, index: 58, itemText: "Produces wh-questions" },
            { group: 4, index: 59, itemText: "Speaks for toys or characters during play" },
            { group: 4, index: 60, itemText: "Retells familiar stories" },
            { group: 4, index: 61, itemText: "Responds to wh-questions" },
            { group: 4, index: 62, itemText: "Changes voice tones and words depending on the conversation partner" },
            { group: 4, index: 63, itemText: "Uses contractions" },
            { group: 4, index: 64, itemText: "Tells a lie occasionally" },
            { group: 4, index: 65, itemText: "Takes turns and comments during conversation" },
            { group: 4, index: 66, itemText: "Uses complex sentences" },
            { group: 4, index: 67, itemText: "Uses sentences of five or more words" },
            { group: 4, index: 68, itemText: "Counts in order" },
            { group: 4, index: 69, itemText: "Recognizes when something he/she said hurt another person" },
            { group: 4, index: 70, itemText: "Describes imaginary events" },
            { group: 4, index: 71, itemText: "Asks \"How\" or \"Why\" questions" },
            { group: 4, index: 72, itemText: "Expresses inner thoughts and ideas" },
            { group: 4, index: 73, itemText: "Explains rules of a familiar game" },
            { group: 4, index: 74, itemText: "Volunteers own age to others" },
            { group: 4, index: 75, itemText: "Produces past-tense irregular verbs" },
            { group: 4, index: 76, itemText: "Uses rhyming words" },
        ]
    };

    // generates html elements in accordance to textItems
    (function() {

        // helper function to add title to div
        var addTitleDiv = function(parentDiv) {

            var divElem;
            var spanP;
            var spanM;
            var spanU;

            divElem = document.createElement("div");
            spanP = document.createElement("span");
            spanM = document.createElement("span");
            spanU = document.createElement("span");

            spanP.setAttribute("class", "rb-title");
            spanM.setAttribute("class", "rb-title");
            spanU.setAttribute("class", "rb-title");

            spanP.textContent = "+";
            spanM.textContent = "-";
            spanU.textContent = "untested";

            divElem.appendChild(spanP);
            divElem.appendChild(spanM);
            divElem.appendChild(spanU);

            parentDiv.appendChild(divElem);
        };

        // helper function to add radio button to div
        var addRadioButton = function(rbTextItem, rbIndex, parentDiv, typeValue) {

            var curName;
            var newDiv;
            var rbP, rbM, rbU;
            var spanElem;

            newDiv = document.createElement("div");
            rbP = document.createElement("input");
            rbM = document.createElement("input");
            rbU = document.createElement("input");
            spanElem = document.createElement("span");

            curName = "rb_"+typeValue+rbIndex;

            rbP.setAttribute("type", "radio");
            rbP.setAttribute("name", curName);
            rbP.setAttribute("value", "plus");

            rbM.setAttribute("type", "radio");
            rbM.setAttribute("name", curName);
            rbM.setAttribute("value", "minus");

            rbU.setAttribute("type", "radio");
            rbU.setAttribute("name", curName);
            rbU.setAttribute("value", "untested");
            rbU.setAttribute("checked", "checked");

            spanElem.setAttribute("class", "rb-label");
            spanElem.textContent = textItems[ typeValue ][ rbIndex ].index + ". " + textItems[ typeValue ][ rbIndex ].itemText;

            // add created elements to document
            newDiv.appendChild(rbP);
            newDiv.appendChild(rbM);
            newDiv.appendChild(rbU);
            newDiv.appendChild(spanElem);

            parentDiv.appendChild(newDiv);
        };

        // helper function to build input elements
        var buildInputPage = function(parentDiv, typeValue) {

            var curSubdiv;
            var curAgeGroup = -1;

            textItems[ typeValue ].forEach( function(rbTextItem,rbIndex) {

                if (rbTextItem.group !== curAgeGroup) {
                    // new age group

                    // complete previous group unless prev group is -1
                    if (curAgeGroup !== -1) {
                        parentDiv.appendChild(curSubdiv);
                    }

                    // start new group
                    var h2Elem = document.createElement("h2");

                    curAgeGroup += 1;
                    h2Elem.setAttribute("class", "h2_"+typeValue);
                    h2Elem.textContent = ageGroupLabels[curAgeGroup]+": Language "+typeValue;

                    // append new age group
                    parentDiv.appendChild(h2Elem);

                    // create new div for radio buttons
                    curSubdiv = document.createElement("div");

                    // add + - title to new subdiv
                    addTitleDiv(curSubdiv);
                }

                // add new radio item to current
                addRadioButton(rbTextItem, rbIndex, curSubdiv, typeValue);
            } );

            parentDiv.appendChild(curSubdiv);
        };

        var inputDivLeft = document.getElementById("inputAreaLeft");
        var inputDivRight = document.getElementById("inputAreaRight");

        buildInputPage(inputDivLeft, "receptive");
        buildInputPage(inputDivRight, "expressive");
    })();


    // helper function to format output text appropriately
    var formatText = function(indexArray, type, typeValue) {
        var count = indexArray[ typeValue ].length;

        if (count === 0) {
            return "";
        }

        var sentenceSubjectText = "";
        var sentenceVerbsText = "";
        var verbFormIndex;

        if (type === "cannot") {
            sentenceSubjectText = "(unable to do in "+typeValue+"):";
            verbFormIndex = "cannot";
        }
        else {
            sentenceSubjectText = "(able to do in "+typeValue+"):";
            verbFormIndex = "can";
        }

        if (count === 1) {
            // only one item, no need to add "and"
            sentenceVerbsText = " "+textItems[ typeValue ][ indexArray[ typeValue ][0] ][ verbFormIndex ];
        }
        else {
            for (var i=0; i<count; i++) {
                if (i === count-1) {
                    // add and if last item in list
                    sentenceVerbsText += " and";
                }

                sentenceVerbsText += " "+textItems[ typeValue ][ indexArray[ typeValue ][i] ][ verbFormIndex ];

                if (i < count-2) {
                    // add comma if before second to last item in list 
                    sentenceVerbsText += ",";
                }
            }
        }

        // add full stop
        sentenceVerbsText += "."

        return sentenceSubjectText + sentenceVerbsText;
    };

    // update function for bulletpoint divs
    var UpdateBulletPointDivText = function(indexArrayArray, typeValue) {
        // grab bulletpoint div
        var bpDiv = document.getElementById( "bulletPointOutput-"+typeValue );
        if( !bpDiv ) { return; }

        // clear div
        bpDiv.innerHTML = "";

        const HEADER_TEXT = [
            "(able to do in ",
            "(unable to do in ",
        ];
        indexArrayArray.forEach( function( indexArray, indexArray_index ) {
            var headerDiv = document.createElement( "div" );
            headerDiv.classList.add( "div_bulletPointDivHeader" );
            headerDiv.appendChild( document.createTextNode( HEADER_TEXT[ indexArray_index ]+typeValue.toUpperCase()+"):" ) );
            bpDiv.appendChild( headerDiv );

            var count = indexArray[ typeValue ].length;

            if (count === 0) { return; }

            // create list object
            var listElem = document.createElement( "ul" );

            indexArray[ typeValue ].forEach( function( indexValue, index_index ) {
                var listItem = document.createElement( "li" );
                listItem.appendChild( document.createTextNode( textItems[ typeValue ][ indexValue ].itemText ) );
                listElem.appendChild( listItem );
            } );

            // list done, add to div
            bpDiv.appendChild( listElem );
        } );

        return;
    };

    // helper function to scan radio buttons
    var scanRadioButtons = function(typeValue, canIndexArray, cannotIndexArray) {
        var rbIndex = 0;

        while (true) {
            var curName = "rb_"+typeValue+rbIndex;
            curRadioButtonArray = document.getElementsByName(curName);
            var length = curRadioButtonArray.length;

            if (length === 0) break;

            var curVal;
            for (var i=0; i<length; i++) {
                if (curRadioButtonArray[i].checked) {
                    curVal = curRadioButtonArray[i].value;
                    break;
                }
            }

            if (curVal === "plus") {
                canIndexArray[ typeValue ].push(rbIndex);
            }
            else if (curVal === "minus") {
                cannotIndexArray[ typeValue ].push(rbIndex);
            }

            rbIndex++;
        }
    };

    // update report content inside textarea
    var updateReport = function(leftOrRight) {
        return function(event) {
            var text = "";
            var curRadioButton;

            var canIndexArray = { receptive: [], expressive: [] };
            var cannotIndexArray = { receptive: [], expressive: [] };

            // loop to scan selections and store results in index arrays
            if ( leftOrRight === 'left' ) {
                // only process receptive for left
                scanRadioButtons("receptive", canIndexArray, cannotIndexArray);
                UpdateBulletPointDivText( [ canIndexArray, cannotIndexArray ], "receptive");
            }
            else {
                // only process expressive for right
                scanRadioButtons("expressive", canIndexArray, cannotIndexArray);
                UpdateBulletPointDivText( [ canIndexArray, cannotIndexArray ], "expressive");
            }
        };
    };

    // select all text in textarea
//    var selectAllText = function(event) {
//        event.preventDefault();
//        setTimeout(function() { event.target.select(); }, 1); 
//    };

    var tempTypes = [ 'left', 'right' ];
    tempTypes.forEach( function( lOrR, index ) {
        goButton = document.getElementById( 'createReport-'+lOrR );
        goButton.addEventListener( 'click', updateReport( lOrR ) );
    } );

//    outputArea.addEventListener("focus", selectAllText);
    </script>
</body>
</html>
